 <h1 align="center">Sakura_Mini_Adminåå°ç®¡ç†ç³»ç»Ÿ</h1>
<h4 align="center">ğŸš€å¿«é€Ÿå¼€å‘ã€âœ…åå°å¤šç«¯è‡ªé€‚åº”</h4> 
<p align="center">
<a href="https://www.java.com/zh-CN/download/"><img src="https://img.shields.io/badge/Python-3.8-fadf6f"> </a> 
<a href="#"> <img src="https://img.shields.io/badge/FastAPI-0.88.0-46968a"> </a>
<a target="_blank" href="https://www.docker.com/"><img src="https://img.shields.io/badge/Docker--139cff"> </a>
</p>

# ğŸ‘¨â€ğŸ’»â€ç®€ä»‹ Sakura_Mini_Admin

## ğŸ‘»ä»‹ç»

> æ¬¢è¿æ¥åˆ°Sakura_Mini_Adminåå°ç®¡ç†ç³»ç»Ÿï¼Œä¸€ä¸ªç®€æ´è½»å¿«çš„åå°ç®¡ç†æ¡†æ¶.æ”¯æŒæ‹¥æœ‰å¤šç”¨æˆ·ç»„çš„RBACç®¡ç†åå° ğŸš€

<h1 align="center">
    <a>
        <img src="https://readme-typing-svg.herokuapp.com?color=%2336BCF7&lines=æ˜¥æš–èŠ±å¼€ï¼Œç™¾äº‹å¯ä¹.;console.log(%22Hello%EF%BC%8CSakuta_MiNi_Admin%22)">  
    </a>
</h1>

## Built with

* [![Python][Python]][python-url] 
* [![FastAPI][FastAPI]][fastapi-url]
* [![Pydantic][Pydantic]][pydantic-url]
* [![Uvicorn][uvicorn]][uvicorn-url]
* [![Redis][redis]][redis-url]
* [![jwt][jwt]][jwt-url]
* [![Pytest][pytest]][pytest-url]
* [![Nginx][Nginx]][Nginx-url]
* [![Pycharm][Pycharm]][Pycharm-url]
* [![Markdown][Markdown]][Markdown-url]
* [![Swagger][Swagger]][Swagger-url]
* ELK
* Mysql
* Casbin
* Httprunner
* Docker

## ğŸ§ğŸ’»â€ç›®å½•

```shell
â”œâ”€ğŸ“‚ Sakura_MiNi_Admin          //æœåŠ¡ç«¯æ ¹ç›®å½•ï¼ˆç®¡ç†åå°ã€æ¥å£ï¼‰
â”‚  â”œâ”€ğŸ“‚ back                    //åç«¯åº”ç”¨
â”‚  â”‚  â”œâ”€ğŸ“‚ app                  //åå°åº”ç”¨
â”‚  â”‚  â”‚  â”‚  â”œâ”€ğŸ“„ __init__.py
â”‚  â”‚  â”‚  â”‚  â”œâ”€ğŸ“„ config.py      //é…ç½®æ–‡ä»¶
â”‚  â”‚  â”‚  â”‚  â”œâ”€ğŸ“„ mysql.py    //æ•°æ®åº“ä»¥åŠè¿æ¥çš„é…ç½®
â”‚  â”‚  â”‚  â”œâ”€ğŸ“‚ conf              //ç¯å¢ƒåº”ç”¨
â”‚  â”‚  â”‚  â”‚  â”œâ”€ğŸ“„ dev.env        //å¼€å‘ç¯å¢ƒ
â”‚  â”‚  â”‚  â”‚  â”œâ”€ğŸ“„ pro.env        //çº¿ä¸Šç¯å¢ƒ
â”‚  â”‚  â”‚  â”œâ”€ğŸ“‚ crud              //APIåº”ç”¨
â”‚  â”‚  â”‚  â”‚  â”œâ”€ğŸ“„ __init__.py
â”‚  â”‚  â”‚  â”‚  â”œâ”€ğŸ“„ services.py    //æ¥å£å¢åˆ æ”¹æŸ¥
â”‚  â”‚  â”‚  â”œâ”€ğŸ“‚ logs              //æ—¥å¿—å±‚
â”‚  â”‚  â”‚  â”œâ”€ğŸ“‚ models            //æ•°æ®åº“æ¨¡å‹
â”‚  â”‚  â”‚  â”œâ”€ğŸ“‚ router            //æ¨¡å—è·¯ç”±
â”‚  â”‚  â”‚  â”œâ”€ğŸ“‚ schemas           //æ•°æ®æ¨¡å‹
â”‚  â”‚  â”‚  â”œâ”€ğŸ“‚ utils             //å·¥å…·ç›®å½•
â”‚  â”‚  â”‚  â”‚  â”œâ”€ğŸ“„ __init__.py
â”‚  â”‚  â”‚  â”‚  â”œâ”€ğŸ“„ casbin.py      //æƒé™å·¥å…·
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ğŸ“„ lark_test_report.py   //é£ä¹¦æœºå™¨äººå·¥å…·
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ğŸ“„ logger.py     //æ—¥å¿—å·¥å…·
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ğŸ“„ password.py   //å“ˆå¸Œå¯†ç åŠ å¯†/è§£å¯†å·¥å…·
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ğŸ“„ token.py      //é‰´æƒå·¥å…·
â”‚  â”‚  â”œâ”€ğŸ“„ main.py              //é¡¹ç›®å…¥å£æ–‡ä»¶
â”‚  â”‚  â”œâ”€ğŸ“„ rbac_model.conf      //è§’è‰²æƒé™è®¾è®¡
â”‚  â”œâ”€ğŸ“‚ hrun_proj               //httprunnerå·¥ç¨‹
â”‚  â”œâ”€ğŸ“‚ static                  //é™æ€ç›®å½•ï¼ˆæš‚æœªæ¥å…¥ï¼‰
â”‚  â”œâ”€ğŸ“‚ migrations              //æ•°æ®è¿ç§»ï¼ˆæš‚æœªæ¥å…¥ï¼‰
â”‚  â”œâ”€ğŸ“‚ tests                   //æµ‹è¯•ç”¨ä¾‹ï¼ˆæš‚æœªä½¿ç”¨ï¼‰
â”‚  â”œâ”€ğŸ“„ .gitignore              //gitcommitå¿½ç•¥æ–‡ä»¶
â”‚  â”œâ”€ğŸ“„ docker-compose.yml      //docker-composeç¼–æ’
â”‚  â”œâ”€ğŸ“„ Dockerfile              //Dockerfileç¼–æ’
â”‚  â”œâ”€ğŸ“„ README.md               //ä½¿ç”¨æ–‡æ¡£
â”‚  â”œâ”€ğŸ“„ requirements.txt        //é¡¹ç›®ä¾èµ–æ–‡ä»¶
â”‚  â”œâ”€ğŸ“„ start.sh                //é¡¹ç›®è¿è¡Œè„šæœ¬
```

## ğŸ’½éƒ¨ç½²(æ–¹å¼ä¸€ æœ¬åœ°)

Gitå…‹éš†æˆ–æ˜¯ä¸‹è½½å‹ç¼©åŒ…ã€‚

```git
git clone https://github.com/ranyong1997/Sakura_Mini_Admin.git
```

## ç¯å¢ƒè¦æ±‚

ğŸ§°æœåŠ¡ç«¯

| è¿è¡Œç¯å¢ƒ   | è¦æ±‚ç‰ˆæœ¬  |   æ¨èç‰ˆæœ¬ |
|--------|:-----:|-------:|
| Python | >=3.8 | 3.8.10 |
| Mysql  | >=8.0 | 8.0.24 |
| Redis  | >=8.0 |  7.0.4 |

ğŸ§°å‰ç«¯

| è¿è¡Œç¯å¢ƒ    |   è¦æ±‚ç‰ˆæœ¬    |   æ¨èç‰ˆæœ¬ |
|---------|:---------:|-------:|
| Node.js | >=16.17.0 | 18.9.1 |

åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ(win)

```python
python - m venv venv
```

![image-20230109105555094](https://cdn.jsdelivr.net/gh/ranyong1997/image_collect@main/img/202301091056655.png)

æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆwinï¼‰

```shell
>>>cd .\venv\Scripts\
>>> .\activate
```

æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆMacï¼‰

```shell
#python3é»˜è®¤å®‰è£…virtualenvç¯å¢ƒ
>>>pip3 install virtualenv
#å®‰è£…å®Œæˆæ£€æµ‹ç‰ˆæœ¬æ˜¯å¦å®‰è£…æˆåŠŸ
>>>virtualenv --version
#åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
>>>virtualenv venv
#è¿›å…¥è™šæ‹Ÿç¯å¢ƒ
>>>cd venv 
#æŸ¥çœ‹å½“å‰è·¯å¾„
>>>pwd
eg:/Users/ranyong/Desktop/gitpush/Sakura_Mini_Admin/venv
#æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
>>source /Users/ranyong/Desktop/gitpush/Sakura_Mini_Admin/venv/bin/activate
#é€€å‡ºè™šæ‹Ÿç¯å¢ƒ
deactivate
```

ç»ˆç«¯è¿›å…¥ç¨‹åºçš„æ ¹ç›®å½•ï¼š

```
pip3 install -r requirements.txt
cd back
python3 main.py
```

## ğŸ’½éƒ¨ç½²(æ–¹å¼äºŒ Docker)

```docker
docker-compose up -d
```

> ğŸ“¢æ³¨æ„äº‹é¡¹ï¼šéƒ¨ç½²å‰è¯·æ£€æŸ¥æœ¬åœ°mysqlç«¯å£3306æ˜¯å¦å¼€å¯ï¼Œå¦‚æœå¼€å¯ï¼Œè¯·å…³é—­ã€‚å¦åˆ™æ›´æ”¹3306æ˜ å°„ç«¯å£

## ğŸ¤¦â€å¾…åŠæ¸…å•ï¼š
- [ ] å®Œå–„READMEæ–‡æ¡£
- [ ] ä¸€ä¸ªåŠŸèƒ½å•ç‹¬å¼€ä¸€ä¸ªåˆ†æ”¯
- [ ] æ•°æ®è¿ç§»ã€å®šæ—¶å¤‡ä»½
- [ ] æ›¿æ¢å¼‚æ­¥mysql
- [ ] æ—¥å¿—ä¼˜åŒ–è¾“å‡ºæ§åˆ¶å°
- [ ] å•å…ƒæµ‹è¯•
- [ ] å¢åŠ Jenkinsfileæ‰“åŒ…
- [ ] æ–°å¢ä¿®æ”¹å¯†ç ç§»é™¤redisTokenç¼“å­˜
- [ ] æ•°æ®åº“è‡ªå®šä¹‰åˆ›å»ºè¡¨ã€å­—æ®µ
- [ ] æ¥å…¥Scrapyçˆ¬è™«
- [ ] æµ‹è¯•ç¯å¢ƒå’Œæ­£å¼ç¯å¢ƒä¸€é”®åˆ‡æ¢å¼€å…³
- [ ] å†™ä¸€ä¸ªè·å–èœå•çš„æ¥å£
- [ ] å°†ELKå•ç‹¬ç”¨Dockerå¯åŠ¨


## ğŸ¤¦â€å·²åŠæ¸…å•ï¼š
- [X] ä½¿ç”¨Dockerfileè¿›è¡Œæ„å»º
- [X] ä½¿ç”¨Mysqlæ¥æ›¿sqlite
- [X] å°è£…mysqlè´¦å·å¯†ç åˆ°config.pyé‡Œé¢
- [X] æ¥å…¥Redis
- [X] redisæ¥å…¥Dockerfileé‡Œ
- [X] æ¥å…¥Httprunner
- [X] å¢åŠ ç™»å½•éªŒè¯ç å›¾ç‰‡æ¥å£
- [X] é‡‡ç”¨slimæ‰“åŒ…æ›´å°çš„Dockeré•œåƒ,åŒ…ä½“ç§¯ä»1G+ç¼©å°åˆ°500Mä»¥å†…
- [X] å®ç°å•ç‚¹ç™»å½•åŠŸèƒ½
- [X] å¯†ç é‡ç½®åŠŸèƒ½
- [X] ä¼˜åŒ–docsæ–‡æ¡£åŠ è½½æ—¶é—´
- [X] devç¯å¢ƒä¸‹ä¸å¯åŠ¨docsè°ƒè¯•æ–‡æ¡£
- [X] å¼•å…¥APScheduler
- [X] è®°å½•è¯·æ±‚æ—¥å¿—
- [x] httpå‘é€æ¥å£,é‡‡ç”¨aiohttp,å¹¶æŒä¹…åŒ–ä¿å­˜
- [x] æ¶‰åŠåˆ°å¯†ç çš„ï¼Œæ•°æ®åº“ä¿ç•™sha256(å·²å®ç°),å‰ç«¯ä¼ è¾“ç”¨AES
- [x] æ–°å¢åˆ†é¡µæŸ¥è¯¢
- [x] æ–°å¢websocket
- [x] é‡å†™APScheduler
- [x] æ¥å…¥ELKæ—¥å¿—ç³»ç»Ÿ

### âœ¨Httprunnerå¿«é€Ÿä½“éªŒ

> run_har2caseâ€”â€”>"har\requests.har"

> run_har2case å°†haræ–‡ä»¶è½¬åŒ–ä¸ºhttprunnerç”¨ä¾‹

> run_subprocess æ‰§è¡Œç”¨ä¾‹,ä½¿ç”¨pytestçš„æ–¹å¼æ‰§è¡Œhttprunnerç”¨ä¾‹,å¾—åˆ°æ‰§è¡Œç»“æœ

> run_subprocessâ€”â€”>"testcases\requests.json"

> run_debug åœ¨çº¿è°ƒè¯•,ç”¨äºæ¥å£è°ƒè¯•,ä½¿ç”¨run_har2caseè½¬æ¢åçš„jsonå†…å®¹åœ¨çº¿æ‰§è¡Œ,å¾—åˆ°æ¥å£å“åº”ç»“æœ


## ğŸ“¢å¼€å‘æäº¤è§„èŒƒ:

```text
âœ¨ feat:():æ–°å¢
ğŸ Fix:():ä¿®å¤
ğŸ“ƒ docs:():æ–‡æ¡£
ğŸ¦„ refactor:():é‡æ„
ğŸˆ perf:():ä¼˜åŒ–
```

## ğŸ›°ï¸APIæ–‡æ¡£

***APIæ–‡æ¡£ï¼š***
æœ¬åœ°æ–‡æ¡£ï¼š[http://localhost:8000/docs](http://localhost:8000/docs)


## âš¡API è¯´æ˜
<details><summary>ğŸ”ç‚¹å‡»å±•å¼€</summary>

GETï¼š`/news_api`

### è¯·æ±‚å‚æ•°

| å‚æ•°å           | ä½ç½®  | ç±»å‹   | å¿…å¡« | ç¤ºä¾‹å€¼ | è¯´æ˜                                                        |
| :--------------- | ----- | ------ | ---- | ------ | ----------------------------------------------------------- |
| _vercel_no_cache | query |        | å¦   | 1      | è¯´æ˜ï¼š`vercel` å¼ºåˆ¶ä¸ç¼“å­˜                                   |
| cache            | query |        | å¦   | ä»»æ„å€¼ | è¯´æ˜ï¼šæ¸…é™¤ç¼“å­˜ç”¨                                            |
| index            | query | number | å¦   | 0      | è¯´æ˜ï¼š`0-99` ç”¨æ¥æ§åˆ¶å¤©æ•°ï¼Œ`0` ä¸ºä»Šå¤©ï¼Œ`1` ä¸ºæ˜¨å¤©ï¼Œä¾æ¬¡ç±»æ¨ |
| origin           | query | string | å¦   | zhihu  | è¯´æ˜ï¼š"`zhihu`" æˆ– "`163`" åˆ‡æ¢æº                           |
</details>

## ğŸ¦„Casbinæ•°æ®åº“ERå›¾

![æ•°æ®åº“ERå›¾](https://cdn.jsdelivr.net/gh/ranyong1997/image_collect@main/img/202304041543880.png)

## ğŸ“¸æˆªå›¾

***é¡¹ç›®ç•Œé¢***

<details><summary>ğŸ”ç‚¹å‡»å±•å¼€æˆªå›¾</summary>
  <img  width="80%"  src="https://cdn.jsdelivr.net/gh/ranyong1997/image_collect@main/img/202302150953778.png" /><br>
  <img  width="80%"  src="https://cdn.jsdelivr.net/gh/ranyong1997/image_collect@main/img/202302150955926.png" /><br>
  <img  width="80%"  src="https://cdn.jsdelivr.net/gh/ranyong1997/image_collect@main/img/202302150956145.png" /><br>
  <img  width="80%"  src="https://cdn.jsdelivr.net/gh/ranyong1997/image_collect@main/img/202302150952967.png" /><br>
  <img  width="80%"  src="https://cdn.jsdelivr.net/gh/ranyong1997/image_collect@main/img/202302150951340.png" /><br>
</div>
</details>
<hr>

[Python-docs]: https://docs.python.org/3.8/

[Python]: https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54

[FastAPI]: https://img.shields.io/badge/FastAPI-FFFFFF?style=for-the-badge&logo=fastapi

[Pydantic]: https://img.shields.io/badge/Pydantic-FF43A1?style=for-the-badge&logo=pydantic&logoColor=white

[Uvicorn]: https://img.shields.io/badge/Uvicorn-2A308B?style=for-the-badge&logo=uvicorn&logoColor=white

[Pytest]: https://img.shields.io/badge/Pytest-0A9EDC?style=for-the-badge&logo=pytest&logoColor=white

[Redis]: https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=redis&logoColor=white

[JWT]: https://img.shields.io/badge/JWT-black?style=for-the-badge&logo=JSON%20web%20tokens

[Nginx]: https://img.shields.io/badge/Nginx-009639?style=for-the-badge&logo=nginx&logoColor=white

[PyCharm]: https://img.shields.io/badge/PyCharm-21D789?style=for-the-badge&logo=pycharm&logoColor=white

[Markdown]: https://img.shields.io/badge/Markdown-000000?style=for-the-badge&logo=markdown&logoColor=white

[Swagger]: https://img.shields.io/badge/-Swagger-%23Clojure?style=for-the-badge&logo=swagger&logoColor=white

[python-url]: https://www.python.org/

[fastapi-url]: https://fastapi.tiangolo.com

[pydantic-url]: https://docs.pydantic.dev

[uvicorn-url]: https://www.uvicorn.org/

[pytest-url]: https://docs.pytest.org/en/7.2.x/

[redis-url]: https://redis.io/

[jwt-url]: https://jwt.io/

[Pycharm-url]: https://www.jetbrains.com/pycharm/

[Nginx-url]: https://www.nginx.com/

[Markdown-url]: https://daringfireball.net/projects/markdown/

[Swagger-url]: https://swagger.io/